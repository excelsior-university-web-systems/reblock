(()=>{"use strict";const e=window.wp.plugins,t=window.wp.editor,n=window.wp.components,r=window.wp.data,i=window.wp.element,l=window.wp.coreData,o=window.wp.primitives,s=window.ReactJSXRuntime,a=(0,s.jsx)(o.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)(o.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M5.5 12a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0ZM12 4a8 8 0 1 0 0 16 8 8 0 0 0 0-16Zm-.75 12v-1.5h1.5V16h-1.5Zm0-8v5h1.5V8h-1.5Z"})});(0,e.registerPlugin)("reblock-usage-tracker",{render:()=>{const e=(0,r.useSelect)((e=>e("core/editor").getEditedPostAttribute("meta")||{}),[]),i=Array.isArray(e._reblock_used_in)?e._reblock_used_in:[],o=(0,r.useSelect)((e=>{if(!i.length)return[];const t=i.reduce(((e,{id:t,type:n})=>((e[n]=e[n]||[]).push(t),e)),{});let n=[];for(const[r,i]of Object.entries(t)){const t=e(l.store).getEntityRecords("postType",r,{include:i,per_page:i.length});if(null===t)return;n=n.concat(t)}return n}),[i]);return(0,s.jsx)(t.PluginDocumentSettingPanel,{name:"reblock-usage-panel",title:"ReBlock Usage",className:"reblock-usage-panel",icon:a,initialOpen:!0,children:void 0===o?(0,s.jsx)(n.Spinner,{}):o.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"This ReBlock appears in the following posts and pages. Changes to this ReBlock will affect all listed items."}),(0,s.jsx)("ul",{style:{listStyle:"revert",padding:"revert"},children:o.map((e=>(0,s.jsx)("li",{children:(0,s.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",children:e.title.rendered||`#${e.id}`})},e.id)))}),(0,s.jsxs)(n.Notice,{status:"warning",__unstableHTML:!0,isDismissible:!1,children:[(0,s.jsx)("strong",{children:"Warning:"})," This list excludes any instances of the ReBlock content that have been embedded via iframe on external websites. Updates to this ReBlock will still propagate to those external iframe embeds."]})]}):(0,s.jsx)("p",{children:(0,s.jsx)("em",{children:"No references found."})})})},icon:a}),(0,e.registerPlugin)("reblock-embed-meta-box",{render:()=>{const e=(0,r.useSelect)((e=>e("core/editor").getCurrentPostId()),[]),l=(0,r.useSelect)((e=>e("core/editor").getPermalink()),[]),o=(0,r.useSelect)((e=>e("core/editor").getCurrentPostType()),[]),a=(0,r.useSelect)((e=>e("core").getPostType(o)),[]),[d,c]=(0,i.useState)(!1);if(!a||!0!==a.viewable)return null;const u=`<iframe data-reblock="${e}" style="width: 100%; height: auto; overflow: hidden; border: none;" scrolling="no" src="${l}"></iframe>`;return(0,s.jsxs)(t.PluginDocumentSettingPanel,{name:"reblock-embed",title:"Reblock Embed Code",className:"reblock-embed",initialOpen:!0,children:[(0,s.jsx)(n.TextareaControl,{label:"Embed Code",value:u,readOnly:!0,__nextHasNoMarginBottom:!0}),(0,s.jsx)(n.Button,{variant:"primary",onClick:()=>{navigator.clipboard.writeText(u).then((()=>{c(!0),setTimeout((()=>c(!1)),3e3)}))},disabled:d,style:{marginTop:"6px"},__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,children:d?"Copied":"Copy"})]})}})})();