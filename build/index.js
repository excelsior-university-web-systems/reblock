(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,n=JSON.parse('{"apiVersion":3,"name":"reblock/reblock-block-selector","title":"ReBlock","description":"Insert reusable block content.","version":"1.0.0","category":"reblock-blocks","supports":{"html":false,"multiple":true,"inserter":true},"attributes":{"blockId":{"type":"number","default":0},"isBootstrap":{"type":"boolean","default":false}},"editorScript":"file:./index.js","editorStyle":"file:./editor.css"}'),o=window.wp.blockEditor,s=window.wp.components,r=window.wp.data,l=window.wp.element,i=window.wp.apiFetch;var a=e.n(i);const c=window.lodash,d=window.ReactJSXRuntime;(0,t.registerBlockType)(n,{icon:{src:(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"36",height:"36","aria-hidden":"true",focusable:"false",children:(0,d.jsx)("path",{d:"M4 6h12V4.5H4V6Zm16 4.5H4V9h16v1.5ZM4 15h16v-1.5H4V15Zm0 4.5h16V18H4v1.5Z"})})},edit:function({attributes:e,setAttributes:t,clientId:n}){const{blockId:i,isBootstrap:u}=e,h=(0,o.useBlockProps)({className:"reblock-preview"}),[p,x]=(0,l.useState)(null),[b,w]=(0,l.useState)(0),[f,m]=(0,l.useState)(null),[g,v]=(0,l.useState)([{value:0,label:"Select a ReBlock"}]),[k,j]=(0,l.useState)(i),[B,S]=(0,l.useState)(""),[C,_]=(0,l.useState)(!1),y=`${i}-${b}`,R=(0,r.useSelect)((e=>{const{getBlockParents:t,getBlock:o}=e("core/block-editor");return t(n).some((e=>{const t=o(e);return"excelsior-bootstrap-editor/container"===t?.name}))}),[n]),z=(0,c.debounce)((e=>{a()({path:`/wp/v2/reblock?search=${e}&per_page=10`}).then((e=>{const t=e.map((e=>({value:e.id,label:e.title.rendered})));v(t)})).catch((e=>{console.error("Error fetching posts:",e)}))}),500);(0,l.useEffect)((()=>{i&&a()({path:`/wp/v2/reblock/${i}`}).then((e=>{const t=H(e.content.rendered);e.content.rendered=t,x(e),m(null)})).catch((e=>{x(null),m("There was an error fetching the ReBlock content. "+e.message)}))}),[y]);const N=(e=>{const t=(0,l.useRef)();return(0,l.useEffect)((()=>{t.current=e}),[e]),t.current})(g);(0,l.useEffect)((()=>{null!==N&&(g.length<=0?_(!0):_(!1))}),[g]);const V=e=>{S(e),z(e)},M=e=>{j(e),t({blockId:Number(e)})},D=()=>{w((e=>e+1))},H=e=>{if(R){const n=(new DOMParser).parseFromString(e,"text/html"),o=n.querySelector("#excelsior-bootstrap");if(o){const e=o.querySelector(".page-container");if(e){for(;e.firstChild;)o.parentNode.insertBefore(e.firstChild,o);e.remove(),u||t({isBootstrap:!0})}return o.remove(),n.body.innerHTML}}return u&&t({isBootstrap:!1}),e};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.InspectorControls,{children:(0,d.jsxs)(s.PanelBody,{title:"ReBlock Settings",children:[C?(0,d.jsxs)(s.Notice,{status:"warning",isDismissible:!1,children:[(0,d.jsx)("strong",{children:"No ReBlock found."})," Please try different key words. Current input will not be saved."]}):"",(0,d.jsx)(s.ComboboxControl,{label:"ReBlock",value:k,onChange:M,onFilterValueChange:V,options:g,renderItem:e=>(0,d.jsx)("span",{children:e.label}),expandOnFocus:!1,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,d.jsx)(s.PanelRow,{children:(0,d.jsx)(s.Button,{variant:"primary",onClick:D,__next40pxDefaultSize:!0,text:"Refresh Content"})})]})}),(0,d.jsxs)("div",{...h,children:[(0,d.jsxs)("div",{class:"label",children:[(0,d.jsxs)("span",{children:["Common Block",p?": "+p.title.rendered:""]}),(0,d.jsx)(s.Button,{variant:"link",size:"small",iconSize:12,disabled:!p,href:"/wp-admin/post.php?post="+p?.id+"&action=edit",target:"_blank",__next40pxDefaultSize:!0,icon:(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-pencil-fill",viewBox:"0 0 16 16",children:(0,d.jsx)("path",{d:"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.5.5 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11z"})}),label:"Edit"}),(0,d.jsx)(s.Button,{variant:"link",__next40pxDefaultSize:!0,size:"small",iconSize:16,disabled:!p,icon:(0,d.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-clockwise",viewBox:"0 0 16 16",children:[(0,d.jsx)("path",{"fill-rule":"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),(0,d.jsx)("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"})]}),label:"Refresh Content",onClick:D})]}),f?(0,d.jsx)(s.Notice,{status:"error",isDismissible:!1,children:f}):p?(0,d.jsx)("div",{dangerouslySetInnerHTML:{__html:p.content.rendered}}):0===i?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.ComboboxControl,{className:"editor-combobox",label:"ReBlock",value:k,onChange:M,onFilterValueChange:V,options:g,renderItem:e=>(0,d.jsx)("span",{children:e.label}),expandOnFocus:!1,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),C?(0,d.jsxs)(s.Notice,{status:"warning",isDismissible:!1,children:[(0,d.jsx)("strong",{children:"No ReBlock found."})," Please try different key words. Current input will not be saved."]}):""]}):(0,d.jsxs)("div",{className:"loading-message",children:[(0,d.jsx)("span",{class:"loader"})," Loading content..."]})]})]})},save:function(){return null}})})();